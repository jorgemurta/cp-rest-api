<?php

namespace App\Http\Controllers\ApiV1;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use App\Models\Category;
use App\Models\Event;
use App\Repositories\Contracts\RepositoryInterface;

class IndexController extends Controller
{
    
    /**
     * @var Event
     */
    private $event;
 
    public function __construct(RepositoryInterface $event) {
 
        $this->event = $event;
    }   
     
    
    public function Categories()
    {
        
        $categoryList = Category::get();
        
        $data = [];
        
        foreach($categoryList as $cat) {
            
            $catData = $cat->data;
            $catI18n = [];
            foreach($catData as $cdata) {
                $catI18n[$cdata->lang_iso] = ['title' => $cdata->title, 'description' => $cdata->description]; 
            }
            
            $data[] = array('id' => $cat->id, 'parent' => $cat->parent_id, 'i18n' => $catI18n);
        }
        
        
        return response()->json($data);
        
    }
    
    
    public function Events()
    {
        
        $data = $this->event->findAll();
        
        return response()->json($data);
        
    }
}
